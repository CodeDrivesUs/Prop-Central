@model Flats.SharedModel.LandLordSharedModels.LandLordIndex
@using System.Configuration

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_LayoutLandLord.cshtml";
}

<div class="row">
    <!-- Earnings (Monthly) Card Example -->
    <div class="col-xl-3 col-md-6 mb-4">
        <a href="@Url.Action("Index", "Bookings")">
            <div class="card border-left-primary shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">@Model._flat.Name Bookings</div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800">@Model._flatBookings.Count()</div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-calendar fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </a>
    </div>

    <!-- Earnings (Monthly) Card Example Flatmanager/RentTransactionList -->
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-success shadow h-100 py-2">
            <div class="card-body">
                <div class="row no-gutters align-items-center">

                    @*@if (db.flatAccounts.Where(x => x.flatId == Model.Flatid).Select(x => x.balance).FirstOrDefault() >= 0)
                        {
                            <a href="/Flatmanager/statement">
                                <div class="col mr-2">
                                    <div class="text-xs font-weight-bold text-danger text-uppercase mb-1">You Owe New home solutions</div>
                                    <div class="h5 mb-0 font-weight-bold text-gray-800"> </div>
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-money fa-2x text-gray-300">R @db.flatAccounts.Where(x => x.flatId == Model.Flatid).Select(x => x.balance).FirstOrDefault()</i>
                                </div>
                            </a>
                        }
                        else
                        {
                            decimal acc = db.flatAccounts.Where(x => x.flatId == Model.Flatid).Select(x => x.balance).FirstOrDefault();
                            decimal balance = Convert.ToDecimal(acc * (-1));
                            <a href="/Flatmanager/statement">
                                <div class="col mr-2">
                                    <div class="text-xs font-weight-bold text-success text-uppercase mb-1">You have a credit of :</div>
                                    <div class="h5 mb-0 font-weight-bold text-gray-800"></div>
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-money fa-2x text-gray-300">R @balance.ToString()</i>
                                </div>
                            </a>
                        }*@
                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-md-6 mb-4">
        <a href="/Flatmanager/RentTransactionList">
            <div class="card border-left-primary shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">

                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-success text-uppercase mb-1">Revenue</div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800">
                                @*@{
                                        var flataccountid = db.flatAccounts.Where(x => x.flatId == Model.Flatid).Select(x => x.FlatAccountID).FirstOrDefault();

                                    }
                                    R @db.transactions.Where(x => x.FlatAccountID == flataccountid && x.Type == "Rent").Select(x => x.Amount).ToList().Sum()*@
                            </div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-dollar-sign fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </a>
    </div>
    <!-- Earnings (Monthly) Card Example -->
    @*<div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-left-info shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-info text-uppercase mb-1">Tasks</div>
                            <div class="row no-gutters align-items-center">
                                <div class="col-auto">
                                    <div class="h5 mb-0 mr-3 font-weight-bold text-gray-800">50%</div>
                                </div>
                                <div class="col">
                                    <div class="progress progress-sm mr-2">
                                        <div class="progress-bar bg-info" role="progressbar" style="width: 50%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-clipboard-list fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>*@

    <!-- Pending Requests Card Example -->
    @*<div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-left-warning shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">Pending Requests</div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800">18</div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-comments fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>*@
</div>
<div class="row">
    <div class="col-md-6 product_img">
        @if (Model.ProfilePicture != null)

        {

            <img src="@ConfigurationManager.AppSettings["photosuploadUrl"]@Model.ProfilePicture" height="500" width="550" class="img-responsive">
        }
        else
        {
            <img src="~/Content/jonathan-riley-VW8MUbHyxCU-unsplash.jpg" height="500" width="550" class="img-responsive">
        }


    </div>
    <div class="col-md-6 product_content">
        <h1>@Model._flat.Name <span></span></h1>

        <p><i class="fa fa-location-arrow text-danger"></i>@Model._flat.Address</p>
        <h3 class="cost"><span class="fa fa-money"></span> <span style="color:red;">Renting Price: R @Model._flat.RentingPrice </span> </h3>
        <h3 class="pre-cost"><span class="fa fa-money"></span> <span style="color:lightgreen;">Deposit: R @Model._flat.Deposit</span></h3>
        <div>
            Room Types
            <ul>
                @foreach (var i in Model._flat.ListRoomTypes)
                {
                    <li><i class="fa fa-bed"></i>@i.Name</li>
                }
            </ul>
        </div>
        <div class="btn-ground">
            <a href='#' class="btn btn-primary"><i class="fa fa-eye"></i>View flat</a>
        </div>
    </div>
</div>
<div class="row" style="margin-top:40px">

    <div class="col-lg-12 pull-right">
        <div class="panel-body">

            @if (Model._flatBookings.Count() != 0)
            {
                <h4 style="text-align:center;">TODAY BOOKINGS </h4>

                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>
                                Booking NO:
                            </th>
                            <th>
                                First Name
                            </th>
                            <th>
                                Last Name
                            </th>
                            <th>
                                Phone Numuber
                            </th>
                            <th>
                                Email
                            </th>
                            <th>
                                Viewing date
                            </th>
                            <th></th>
                        </tr>
                    </thead>

                    <tbody>
                        @foreach (var item in Model._flatBookings)
                        {
                            <tr>
                                <td>
                                    @item.Id
                                </td>
                                <td>
                                    @item.FirstName
                                </td>
                                <td>
                                    @item.LastName
                                </td>
                                <td>

                                    @item.PhoneNumber

                                </td>
                                <td>

                                    @item.Email

                                </td>
                                <td>
                                    @item.BookingDate.ToLongDateString()
                                </td>

                                <td>

                                    <form action="/LandLord/Process" method="post">
                                        @Html.AntiForgeryToken()
                                        <input  type="hidden" name="bookingId" value="@item.Id"/>
                                        <input type="submit" class="btn btn-primary" value="Process Booking" />
                                    </form>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            }
            else
            {
                <h3 class="text-muted text-center"> NO BOOKINGS FOR TODAY..</h3>

            }
        </div>
    </div>
</div>
<ul class="list-group">
    <li class="list-group-item text-left text-muted"><center><h4><strong>Flat Statistics</strong></h4></center> <i class="fa fa-dashboard fa-1x"></i></li>
    <li class="list-group-item text-left"><span class="pull-left"><strong>Total Rooms</strong></span> <span class="badge badge-info">212</span></li>
    <li class="list-group-item text-left"><span class="pull-left"><strong>Available Rooms</strong></span> <span class="badge badge-info">121</span></li>
    <li class="list-group-item text-left"><span class="pull-left"><strong>Empty Rooms</strong></span> <span class="badge badge-info">1232 </span></li>
    <li class="list-group-item text-left"><span class="pull-left"><strong>Tenants</strong></span><span class="badge badge-success">323 </span></li>
    <li class="list-group-item text-left"><span class="pull-left"><strong> Available Spaces</strong></span><span class="badge badge-success"> @*@Model.AvailableSpa(Model.Flatid)*@ 345</span></li>
</ul>

